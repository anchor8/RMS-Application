<!-- toggle buttons -->
<div id="accordian">

  <!-- Card -->
  <div class="card mb-4">

    <!-- Card Header -->
    <div class="card-header text-center" id="headingOne" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
      <h5 class="mb-0">
        <button class="btn btn-link" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
          Column Controls
        </button>
      </div>

      <!-- Content -->
      <div id="collapseOne" class="collapse hide" aria-labelledby="headingOne" data-parent="#accordion">

        <!-- Content Body -->
        <div class="card-body">

          <!-- Row 1 -->
          <section class="row">

            <!-- Group column controls -->
            <div class="mb-2 mx-auto btn-group">

              <a class="show-all-col btn btn-primary btn-sm"
                 type="button"
                 data-toggle="button"
                 aria-pressed="false"
                 autocomplete="off"
                 href="">Show All Columns</a>

              <a class="hide-all-col btn btn-primary btn-sm"
                 type="button"
                 data-toggle="button"
                 aria-pressed="false"
                 autocomplete="off"
                 href="">Hide All Columns</a>


            </div>

          </section>

          <!-- Row 2 -->
          <section class="row">

            <!-- Individual column controls -->
            <div class="mb-2 px-4 mx-auto">

              <a class="toggle-vis btn btn-outline-primary btn-sm mb-1"
                 type="button"
                 data-toggle="button"
                 aria-pressed="false"
                 autocomplete="off"
                 data-column="0"
                 href="">Cancel</a>

              <a class="toggle-vis btn btn-outline-primary btn-sm mb-1"
                 type="button"
                 data-toggle="button"
                 aria-pressed="false"
                 autocomplete="off"
                 data-column="1"
                 href="">Edit</a>

              <a class="toggle-vis btn btn-outline-primary btn-sm mb-1"
                 type="button"
                 data-toggle="button"
                 aria-pressed="false"
                 autocomplete="off"
                 data-column="2"
                 href="">PO No.</a>

              <a class="toggle-vis btn btn-outline-primary btn-sm mb-1"
                 type="button"
                 data-toggle="button"
                 aria-pressed="false"
                 autocomplete="off"
                 data-column="3"
                 href="">Date</a>

              <a class="toggle-vis btn btn-outline-primary btn-sm mb-1"
                 type="button"
                 data-toggle="button"
                 aria-pressed="false"
                 autocomplete="off"
                 data-column="4"
                 href="">Status</a>

              <a class="toggle-vis btn btn-outline-primary btn-sm mb-1"
                 type="button"
                 data-toggle="button"
                 aria-pressed="false"
                 autocomplete="off"
                 data-column="5"
                 href="">Company</a>

              <a class="toggle-vis btn btn-outline-primary btn-sm mb-1"
                 type="button"
                 data-toggle="button"
                 aria-pressed="false"
                 autocomplete="off"
                 data-column="6"
                 href="">Customer</a>

              <a class="toggle-vis btn btn-outline-primary btn-sm mb-1"
                 type="button"
                 data-toggle="button"
                 aria-pressed="false"
                 autocomplete="off"
                 data-column="7"
                 href="">Employee</a>

              <a class="toggle-vis btn btn-outline-primary btn-sm mb-1"
                 type="button"
                 data-toggle="button"
                 aria-pressed="false"
                 autocomplete="off"
                 data-column="8"
                 href="">Vendor</a>

              <a class="toggle-vis btn btn-outline-primary btn-sm mb-1"
                 type="button"
                 data-toggle="button"
                 aria-pressed="false"
                 autocomplete="off"
                 data-column="9"
                 href="">Total</a>

              <a class="toggle-vis btn btn-outline-primary btn-sm mb-1"
                 type="button"
                 data-toggle="button"
                 aria-pressed="false"
                 autocomplete="off"
                 data-column="10"
                 href="">Payment Type</a>

            </div>

          </section>

        </div>
      </div>
    </div>
  </div>

<!-- Table Card -->

<div class="card mb-3">

  <!-- Card Header -->
  <div class="card-header">

      <!-- Table Icon -->
      <i class="fa fa-table"></i>

      <!-- Table Name -->
      Order Table

      <div class="btn-right">
        <!-- Add New Order -->
        <%= button_to 'Create New Order',
            new_order_path,
            :method => :get,
            :class => 'btn btn-outline-primary' %>
      </div>

      <div class="btn-right-2">
        <!-- Product Page -->
        <%= button_to 'Products',
            new_product_path,
            :method => :get,
            :class => 'btn btn-outline-primary' %>
      </div>

  </div>

  <!-- Table Card Body -->
  <div class="card-body">

    <!-- Table Type -->
    <div class="table-responsive">

        <table class="table table-bordered table-hover table-striped" id="ordertable" width="100%" cellspacing="0">


          <!-- Top Column Names -->
          <thead>

            <tr>

              <th class="text-center"><font color="gray">Cancel</font></th>
              <th class="text-center"><font color="gray">Edit</font></th>
              <th class="text-center"><font color="gray">PO No.</font></th>
              <th class="text-center"><font color="gray">Date</font></th>
              <th class="text-center">Status</th>
              <th class="text-center"><font color="gray">Company</font></th>
              <th class="text-center"><font color="gray">Customer</font></th>
              <th class="text-center"><font color="gray">Employee</font></th>
              <th class="text-center"><font color="gray">Vendor</font></th>
              <th class="text-center"><font color="gray">Total (USD)</font></th>
              <th class="text-center"><font color="gray">Payment Type</font></th>

            </tr>

          </thead>

          <!-- Bottom Column Names -->
          <tfoot>

            <tr>

              <th class="text-center"><font color="gray">Cancel</font></th>
              <th class="text-center"><font color="gray">Edit</font></th>
              <th class="text-center"><font color="gray">PO No.</font></th>
              <th class="text-center"><font color="gray">Date</font></th>
              <th class="text-center">Status</th>
              <th class="text-center"><font color="gray">Company</font></th>
              <th class="text-center"><font color="gray">Customer</font></th>
              <th class="text-center"><font color="gray">Employee</font></th>
              <th class="text-center"><font color="gray">Vendor</font></th>
              <th class="text-center"><font color="gray">Total (USD)</font></th>
              <th class="text-center"><font color="gray">Payment Type</font></th>



            </tr>

          </tfoot>

          <!-- Content -->
          <tbody>

            <!-- Load order data -->
              <% @orders.each do |order| %>

                  <tr>

                    <!-- Columns to pull from order data -->
                    <td class="text-center">
                      <!-- Disable Button -->
                      <% if !order.deleted_at %>
                        <%= button_to 'Cancel',
                            toggle_order_path(order.id),
                            :method => :put,
                            :class => 'btn btn-outline-danger btn-sm',
                            :data => {
                              :confirm => "Are you sure that you want to cancel the order #" +
                                           order.purchase_order_number.to_s + "?" } %></td>
                      <% else %>
                        <%= button_to 'Undo',
                            toggle_order_path(order.id),
                            :method => :put,
                            :class => 'btn btn-outline-success btn-sm',
                            :data => {
                              :confirm => "Are you sure that you want to undo the cancellation of the order #" +
                                           order.purchase_order_number.to_s + "?" } %></td>
                      <% end %>
                    <td class="text-center">
                      <!-- Edit Button -->
                      <%= button_to 'Edit',
                          edit_order_path(order.id),
                          :method => :get,
                          :class => 'btn btn-outline-success btn-sm' %></td>

                    <td class="text-center"><%= order.purchase_order_number %></td>
                    <td class="text-left-align"><%= order.order_date %></td>
                    <td class="text-left-align"><%= best_in_place order, :order_status_id, :as => :select, :collection => OrderStatus.order('order_status_description asc').where('id != ?', 3).map { |f| [f.id, f.order_status_description]}, :place_holder => order.order_status.order_status_description %></td>
                    <td class="text-left-align"><%= order.customer.company_name %></td>
                    <td class="text-left-align"><%= order.customer.customer_last_name + ", " + order.customer.customer_first_name%></td>
                    <td class="text-left-align"><%= order.employee.lname + ", " + order.employee.fname %></td>
                    <td class="text-left-align"><%= order.vendor.vendor_name %></td>
                    <td class="text-left-align"><%= number_to_currency(order.order_total, precision: 2) %></td>
                    <td class="text-left-align"><%= order.payment_type.payment_type_description %></td>

                  </tr>

              <% end %>

          </tbody>

        </table>

    </div>

  </div>

  <!-- Footnote: Lastest date a order was created -->
  <div class="card-footer small text-muted">



  </div>

</div>

<script>
    $(document).ready(function() {
        var table = $('#ordertable').DataTable( {
            paging: true,
            "order": [[ 3, 'desc' ]]
        } );

        jQuery(".best_in_place").best_in_place();

        // Set all buttons as active on page load
        $('a.toggle-vis').addClass('active')

        // On click hide column
        $('a.toggle-vis').on( 'click', function (e) {

            // Get the column API object
            var column = table.column( $(this).attr('data-column') );

            // Toggle the visibility
            column.visible( ! column.visible() );
        } );

        // Show all columns
        $('a.show-all-col').on( 'click', function (e) {

            // Set all columns to visible
            table.columns( [ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10] ).visible( true, false );

            // adjust column sizing and redraw
            table.columns.adjust().draw( false );

            // Remove inactive class from individual column buttons
            $('a.toggle-vis').removeClass('inactive')

            // Add active class to individual column buttons
            $('a.toggle-vis').addClass('active')

        } );

        // Hide all columns
        $('a.hide-all-col').on( 'click', function (e) {

            // Set all columns to not visible
            table.columns( [ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10] ).visible( false, false );

            // adjust column sizing and redraw
            table.columns.adjust().draw( false );

            // Remove active class from individual column buttons
            $('a.toggle-vis').removeClass('active')

            // Add inactive class to individual column buttons
            $('a.toggle-vis').addClass('inactive')

        } );

    } );
</script>
